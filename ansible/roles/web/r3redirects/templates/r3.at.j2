server {
    listen [::]:443 ssl;
    listen 443 ssl;

    server_name {{ r3rsrv.urls | join(' ') }};

    include snippets/acmetool.conf;
    include snippets/ssl.conf;
    ssl_certificate /var/lib/acme/live/{{ r3rsrv.urls[0] }}/fullchain;
    ssl_certificate_key /var/lib/acme/live/{{ r3rsrv.urls[0] }}/privkey;
    include snippets/hsts.conf;

    include snippets/security-headers.conf;

    root {{ r3rsrv.rootdir }};

    location = /events.ics {
        return 302 https://status.realraum.at/shmcache/grical_realraum.ical; # planned: 301
    }

    location = /events.ical {
        return 302 https://status.realraum.at/shmcache/grical_realraum.ical; # planned: 301
    }

    location = / {
        return 302 https://realraum.at/;
    }

    error_page 404 /404.html;
}
